<script src="//maps.google.com/maps/api/js?key=AIzaSyD2Gwxfy4O60gWgPwTFIrIW8zkK_46gHCw"></script>
<script src="//cdn.rawgit.com/mahnunchik/markerclustererplus/master/dist/markerclusterer.min.js"></script>
<script src='//cdn.rawgit.com/printercu/google-maps-utility-library-v3-read-only/master/infobox/src/infobox_packed.js' type='text/javascript'></script> <!-- only if you need custom infoboxes -->

<geobox-sidebar></geobox-sidebar>

<div id="geolocation"></div>


<script >

  var hours = (new Date()).getHours();
  var mapStyle;

  if (hours > 6 && hours < 20) {
    mapStyle = [
        {"featureType": "administrative", "stylers": [{"visibility": "off"}]},
        {"featureType": "poi", "stylers": [{"visibility": "simplified"}]},
        {"featureType": "road", "elementType": "labels", "stylers": [{"visibility": "simplified"}]},
        {"featureType": "water", "stylers": [{"visibility": "simplified"}]},
        {"featureType": "transit", "stylers": [{"visibility": "simplified"}]},
        {"featureType": "landscape", "stylers": [{"visibility": "simplified"}]},
        {"featureType": "road.highway", "stylers": [{"visibility": "off"}]},
        {"featureType": "road.local", "stylers": [{"visibility": "on"}]},
        {"featureType": "road.highway", "elementType": "geometry", "stylers": [{"visibility": "on"}]},
        {"featureType": "water", "stylers": [{"color": "#84afa3"}, {"lightness": 52}]},
        {"stylers": [{"saturation": -17}, {"gamma": 0.36}]},
        {"featureType": "transit.line", "elementType": "geometry", "stylers": [{"color": "#3f518c"}]}
    ];
  } else {
    mapStyle = [
        {"stylers": [{"hue": "#ff1a00"}, {"invert_lightness": true}, {"saturation": -100}, {"lightness": 33}, {"gamma": 0.5}]},
        {"featureType": "water", "elementType": "geometry", "stylers": [{"color": "#2D333C"}]}
    ]
  }

    var handler = Gmaps.build('Google');
    handler.buildMap({ internal: {id: 'geolocation'}, provider:{
        zoom: 19,
        styles: mapStyle,
        heading: 90,
        tilt: 45
    }}, function(){
        // be aware chrome >= 50 requires https for geolocation to work
        if(navigator.geolocation)
            navigator.geolocation.getCurrentPosition(displayOnMap);
    });

    function displayOnMap(position){
        var marker = handler.addMarker({
            lat: position.coords.latitude,
            lng: position.coords.longitude
        });
        handler.map.centerOn(marker);
    }

    // var sidebar = $('#sidebar').sidebar();

</script>

<style>
  #geolocation {
    height: 100%;
    width: 100%;
    left: 0;
    position: relative;
    top: 0;
  }
</style>